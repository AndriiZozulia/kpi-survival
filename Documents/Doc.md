# KPI Survival

Game development project. KPI 2019

Розробники: Зозуля Андрій, Кошовець Євгеній, Лісогор Андрій

## Загальні положення

KPI Survival – візуальна новела із домішками міні-ігор. Сеттінг - кампус КПІ. Сюжет охоплює життя студента із моменту вступу до кінця першого семестру. Протягом гри у гравця будуть 2 характеристики: репутація та інтелект, які змінюються  в залежності від виборів гравця та результату проходження міні-ігор. Кінцівка буде залежати від їх остаточного значення. (На даний момент наявно 3 міні-ігри та сюжет першої глави)

### Схожі проекти

1. **Doki Doki Literature Club!** Популярна візуальна новела. Як і інші представники жанру має звичайну структуру діалогів. Має особливий драматично-психологічний сюжет.
2. **Steins**** ; ****Gate.**         Науково-фантастична візуальна новела. Виділяється якістю зображень персонажів та фонів.
3. **Відмінності нашої гри.** Сеттінг – реальний світ(КПІ). Фонові зображення та інші ігрові персонажі представляють собою реальні фотографії. Протягом гри у гравця є 2 характеристики, зміни яких він може спостерігати під час гри. Присутні міні-ігри.

### Наш гравець

Нашим гравцем може бути кожен: від простого шанувальника візуальних новел до людини, яка просто хоче поринути у студентське життя. Проте, зрозуміти і справді оцінити всі тонкощі квестової лінії зможе лише справжній студент ФІОТа, котрий не з розповідей знає, що таке перший семестр навчання на улюбленому факультеті кращого технічного університету України.

### Механіки і опис гри

Проходження основного сюжету:

- Перехід до наступної репліки по натиску ЛКМ
- Пропуск цілого діалогу по натиску на кнопку &quot;SKIP&quot;
- Вибір одного із варіантів відповідей, при їх наданні
- Перехід до наступного діалогу по натисканню на виділену область, при наявності останньої
- Поточні значення характеристик можна побачити в розділі &quot;Progress&quot;
- Також в розділі &quot;Progress&quot; можна скинути поточний прогрес та розпочати гру заново.

Міні-гра &quot;Hidden Objects&quot;:

За 30 секунд гравець повинен знайти на фото вказані предмети. При натисненні на предмет, останній вважається знайденим і зникає з екрану. Якщо гравець встигає знайти всі предмети, то отримує бали характеристик, помноженні на коефіцієнт, який залежить від залишеного часу. При поразці бали нараховуються в залежності від знайдених предметів.

Міні-гра &quot;Cheating game&quot;:

     Суть гри: встигнути списати  у сусіда якомога швидше. Є 2 шкали: шкала списаного матеріалу та шкала здоров'я. Перша наповнюється, при натисканні на  кнопку «Обернення» , коли викладач відвернувся, а інша  зменшується при натисканні на ту саму кнопку, коли викладач дивиться на гравця. Гра закінчується, коли наповнюється шкала списаного матеріалу або закінчується шкала здоров'я. По закінченню гравець підвищує свої характеристики в залежності від витраченого часу та успішності виконання.

Міні-гра &quot;Gym&quot;:

     Суть гри: у гравця є 4 спроби, на кожну спробу є 2 секунди. За дві секунди гравець має встигнути натиснути на кнопку «Жим», яка в свою чергу з'являється рандомно в різним частинах екрану. Якщо гравець встигає натиснути кнопку - спробу зараховано. В іншому випадку  - ні.

### Емоційні тригери

1. Enviroment: юзер має отримувати задоволення від навколишнього оточення. Стилістика квестів та дизайн будуть асоціюватися  з його студентським життям та рідним факультетом.

1. Challenge: під час гри юзер буде стикатися з міні-іграми, в яких йому потрібно робити логічні виводи, швидко виконувати завдання на реакцію тощо. Після подолання даних перешкод гравець має отримувати задоволення.

1. Character arcs: В грі є велика кількість діалогів та взаємодії з іншими персонажами. Юзер буде отримувати задоволення з in-game  interactions.

### Плани стосовно подальшого розвитку

1. Дописати сюжет, тобто наповнити його побічними гілками сюжету.
2. Розширити сюжет з одного семестру до 4-х курсів навчання.
3. Збільшити кількість міні-ігор і можливо характеристик.
4. Домовитись стосовно прямої реклами із брендами на території КПІ(Наприклад HappyCake чи  KPIPrint).

Далі описані деякі із реалізованих задач, які виникли в ході роботи над проектом.

# Гра &quot;Hidden objects&quot;


### Задача

Необхідно реалізувати міні-гру з пошуком предметів у общазі.

### Пробеми та реалізація

1. 1) _Проблема:_ В реаліях підходу гри із реальними фотографіями замість усіх ігрових текстур вигадати основний підхід відбору предметів, які будуть адекватно дивитись на завчасно вибраному фоні.

_Реалізація:_ підібравши освітлення максимально наближене до    освітлення фону сфотографувати предмети по одному та вирізати їх за допомогою Photoshop. Потім розташувати та закріпити на фоні , як нам потрібно.

_Альтернативний підхід:_ викласти предмети відразу на потенційний фон та зробити фото, а потім прибирати та ставити по одному всі предмети  туди сюди.

_Переваги:_ не потрібне додаткове обладнання(штатив), легке додавання нових предметів, економія пам&#39;яті.

_Недоліки:_ втрата якості(порівнюючи із альтернативним підходом), неможливість перевикористання предметів при зміні фона.

1. 2)_Проблема_: при натисканні на предмет - він має зникати, як і його назва в списку предметів.

_Реалізація_: на кожен предмет вішається Box Colider, який визначає зону предмета. Є скріпт ClickRespObj, який відслідковую натиснення на предмет та ховає сам предмет та його назву по натисканню.

_Недоліки:_ в скрипті кожному предмету передається відповідний об&#39;єкт з назвою  предмета, що може стати проблемою при подальшій спробі ускладнення гри.

1. 3)_Проблема:_ результати гри повинні впливати на характеристики гравця.

_Реалізація:_ предмети були умовно розбиті на 3 категорії: які впливають на хар-ку Інтелект, які впливають на хар-ку Репутація та які ні на що не впливають. Є клас Controller , який відслідковую: скільки часу залишилось, скільки предметів вже знайдено, та які із знайдених предметів  до якої із категорій належать. Гра може завершитися поразкою, якщо предмети не були вчасно знайдені, та перемогою в протилежному випадку. Задля того, щоб гра впливала на сюжет своїм результатом, але була балансною, на даний момент працює таке правило підрахунку очок. При поразці характеристики збільшуються на кількісті знайдених предметів відповідної категорії. При перемозі ця кількість ще множиться на коефіцієнт, який знаходиться за формулою:

(timeLeft/10+1).

_Недоліки:_ при розширенні сюжети постійно треба відслідковувати баланс очок міні-гри.

_Загальні переваги та недоліки міні-гри:_ кожен раз при проходженні сюжету заново міні-гра ніяк не змінюється, при цьому зберігається достатній рівень казуальності, який відволікає від потоку діалогів та не руйную атмосферу.

**SceneLoader та MiniGamesAction**


**Задача**

1. Наша гра  - це візуальна новела. В ній наявні різноманітні міні-ігри які є окремими сценами. Отже, була необхідність якимось чином контролювати їх. А саме: завершувати гру, розпочинати її, збирати всю необхідну статистику. Робити це потрібно однаково в незалежності від типу міні-гри.

2. Також дуже важливим моментом є те, що необхідно правильно переходити до іншої сцени по завершенню гри та запам&#39;ятовувати останню сцену при збереженні ігрового процесу.

**Рішення**

  Для виконання поставленої задачі ми  створили  окремий клас SceneLoader, який взяв на себе задачу реалізувати логіку загрузки сцени, її збереження шляхом додавання в відповідний пулл.

Працювати з класом SceneLoader було вирішено за допомогою паттерна Singltone, що надає можливість існування глобальної точки доступа до класу.

_Недоліки: глобальні об&#39;єкти можуть бути шкідливі для об&#39;єктного програмування, в деяких випадках призводять до створення  проекту без можливості масштабування._

  Щоб вирішити задачу з контролюванням життєвого циклу міні-ігор було створено клас MiniGameAction, який реалізує методи старту, завершення, збереження статистики для гри.

Реалізація даних методів в свою чергу потребує доступа до логіки класу SceneLoader. Далі за допомогою наслідування контроллер кожної міні-ігри  використовує методи батьківського класу. Це надає можливість відслідковувати початок, завершення кожної гри за певним стандартом.

**Власна фабрика для Visual Novel**

Що таке візуальна новела ? Це - жанр відеоігр, в якому гравцеві демонструється історія за допомогою виводу на екран статичних зображень, тексту і звуків. Нова сцена для кожного діалогу - це дуже накладно зі сторони пам&#39;яті та часу загрузки. Ми вирішили спростити процес генерації діалогів в нашій грі.

**Задача**

Спростити генерацію діалогів та переходів між ними.

**Рішення**

  Розв&#39;язання цієї задачі ми вирішили покласти на файли формату .xml. В нашому проекті наявно 3 типи xml файлів. Це - Dialog, Quest, QuestManager. Як нескладно зрозуміти, кожен тип  - це певний рівень організації. Наприклад на рівень Dialog має такий вигляд:

Його параметрами є id та фонова текстура. Складовими одиницями є репліки, вони мають такі параметри:  саме такст та текстура персонажа.

  Далі йде тип під назвою Quest:

На даному етапі ми формуємо певну послідовність діалогів для визначеного проміжку сюжету, як наприклад «FromDormToLecture»

Одиницями даного xml файлу є діалгори які ми записуємо в порядку розповіді. Також на даному етапі ми включаємо міні-ігри.

  І останній тип - це QuestManager:

Це найвищий рівень в нашій іерархії. Його одиницями є Quest-и.

Отже, створені нами менеджери та парсери, які взаємодіють з xml файлами, дозволяють не змінюючи сцену, встановлювати нові діалоги, текстури оточення, текстури персонажів. Це досить сильно зберегає час та зменшує навантаження на девайс.